<!DOCTYPE html>
<html lang="en">
  <head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <!-- Enable responsiveness on mobile devices-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, viewport-fit=cover">
    <title>A Verse for Barric : SwitchBoard  Reference</title>

    <!-- PhotoSwipe -->
    <link rel="stylesheet" href="/css/photoswipe.css">
    <!-- Skin CSS file (styling of UI - buttons, caption, etc.)
     In the folder of skin CSS file there are also:
     - .png and .svg icons sprite, 
     - preloader.gif (for browsers that do not support CSS animations) -->
    <link rel="stylesheet" href="/css/default-skin.css">
    <!-- Core JS file -->
    <script src="/js/photoswipe.min.js"></script>
    <!-- UI JS file -->
    <script src="/js/photoswipe-ui-default.min.js"></script>

    <!-- CSS -->
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />

    <!-- JS -->
    <script   src="https://code.jquery.com/jquery-3.3.1.min.js"   integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="   crossorigin="anonymous"></script>
    <script src="/js/index-min.js"></script>
    <link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css">
      <script src="/js/highlight.pack.js"></script>
    <script src="js/jazzy.js" defer></script>

    <!-- Fonts -->

    <!-- Icons -->

    <!-- RSS -->
    
</head>
  <body class="docs">
    <a title="SwitchBoard  Reference"></a>
    <header class="partial">
    	<img src="/images/barric_cropped.png" />
    </header>
    
    <section>
        <ul class="nav">
            <li><a href="/thegame">T<span>HE</span> G<span>AME</span></a> <span class="space">&middot;</span></li>
            <li><a href="/motion">M<span>otion</span> G<span>raphics</span></a> <span class="space">&middot;</span></li>
            <li><a href="/illustrations">I<span>llustrations</span></a> <span class="space">&middot;</span></li>
            <li><a href="/animations">A<span>nimations</span></a> <span class="space">&middot;</span></li>
            <li><a href="/soundtrack">S<span>oundtrack</span></a> <span class="space">&middot;</span></li>
            <li><a href="/code">C<span>ode</span></a></li>
        </ul>
    </section>    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">SwitchBoard </a>
        &#8594;
        SwitchBoard 
      </p>
      <p class="coverage"> 73% documented</p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes.html#/PanGesture">PanGesture</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes.html#/c:@M@SwitchBoard@objc(cs)PinchGesture">PinchGesture</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes.html#/s:11SwitchBoard7SBCacheC">SBCache</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SBGameScene.html">SBGameScene</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SBGameScene.html#/s:11SwitchBoard11SBGameSceneC10WorldLayerO">– WorldLayer</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SBGameScene.html#/s:11SwitchBoard11SBGameSceneC12CameraBoundsV">– CameraBounds</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SBSceneManager.html">SBSceneManager</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SBSubScene.html">SBSubScene</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SBSubScene.html#/s:11SwitchBoard10SBSubSceneC9AnimationV">– Animation</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/SBViewDelegate.html">SBViewDelegate</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/SBSceneContainer.html">SBSceneContainer</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/SBSceneContainer.html#/s:11SwitchBoard16SBSceneContainerV10SceneGroupO">– SceneGroup</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h4 id='switchboard' class='heading'>SwitchBoard</h4>

<p>Convenient scene management functions and extensions for SpriteKit projects. Goal is to include tools for:</p>

<ul>
<li>Loading and caching scenes from .sks files</li>
<li>Group scenes together when similar assets need to be loaded / unloaded</li>
<li>Add extensions like scene recording to SKScene</li>
<li>Handle world and debug layers</li>
</ul>
<h5 id='status' class='heading'>Status</h5>

<p>In progress.</p>

<p>Not battle hardened and tested. Still useful though.</p>

<p>Not designed for full flexibility. Scope limited to my projects. I would say 90% could be easily reused.</p>
<h5 id='dependencies' class='heading'>Dependencies</h5>

<p>Needs the Particleboard framework to build. As of this writing, Particleboard is only included for easing functions, so a hard coded easing function could replace this. Subject to change.</p>
<h5 id='usage' class='heading'>Usage</h5>

<p><strong>Loading and Switching Scenes</strong></p>

<p>Let&rsquo;s start by loading one scene. First, create the scene with this criteria:</p>

<ul>
<li>FirstScene.swift which contains a class of <code>FirstScene : SBGameScene</code></li>
<li>FirstScene.sks</li>
</ul>

<p>Next, register the scene in your View Controller. Place this in your <code>viewDidLoad</code>:</p>
<pre class="highlight swift"><code><span class="c1">/// Store a strong reference to the scene manager.</span>
<span class="k">var</span> <span class="nv">sceneManager</span> <span class="p">:</span> <span class="kt">SBSceneManager</span><span class="p">?</span>

<span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>

    <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

    <span class="c1">/// Create an instance of the scene manager</span>
    <span class="k">self</span><span class="o">.</span><span class="n">sceneManager</span> <span class="o">=</span> <span class="kt">SBSceneManager</span><span class="p">(</span><span class="nv">view</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">view</span> <span class="k">as!</span> <span class="kt">SKView</span><span class="p">)</span>

    <span class="c1">/// Register a scene</span>
    <span class="k">self</span><span class="o">.</span><span class="n">sceneManager</span><span class="p">?</span><span class="o">.</span><span class="nf">registerScene</span><span class="p">(</span><span class="s">"FirstScene"</span><span class="p">,</span> 
        <span class="nv">scene</span><span class="p">:</span> <span class="kt">SBSceneContainer</span><span class="p">(</span>
            <span class="nv">classType</span><span class="p">:</span> <span class="kt">FirstScene</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> 
            <span class="nv">name</span><span class="p">:</span> <span class="s">"FirstScene"</span><span class="p">,</span> 
            <span class="nv">transition</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> 
            <span class="nv">preloadable</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> 
            <span class="nv">category</span><span class="p">:</span> <span class="kt">SBSceneContainer</span><span class="o">.</span><span class="kt">SceneGroup</span><span class="o">.</span><span class="kt">World</span><span class="p">,</span> 
            <span class="nv">atlases</span><span class="p">:</span> <span class="p">[</span><span class="s">"atlas1"</span><span class="p">,</span> <span class="s">"atlas2"</span><span class="p">]))</span>

    <span class="c1">/// Display the scene</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">initialScene</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">sceneManager</span><span class="p">?</span><span class="o">.</span><span class="n">scenes</span><span class="p">[</span><span class="s">"FirstScene"</span><span class="p">]</span> <span class="p">{</span>
        <span class="c1">/// Perform more logic like loading a save file here</span>
        <span class="k">self</span><span class="o">.</span><span class="n">sceneManager</span><span class="p">?</span><span class="o">.</span><span class="nf">sceneDidFinish</span><span class="p">(</span><span class="n">initialScene</span><span class="p">)</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre>

<p>At this point, your first scene should properly show and the actual class type of <code>FirstScene</code> is loaded. Also, the atlases needed for the scene were loading in the background, and they will be smartly cached by the scene manager.</p>

<p>Next up, switch to a new scene. </p>

<p>Create your second scene as you did the first. Back in the View Controller, register the second scene in exactly the same fashion as the first.</p>
<pre class="highlight swift"><code><span class="c1">/// Register a scene</span>
<span class="k">self</span><span class="o">.</span><span class="n">sceneManager</span><span class="p">?</span><span class="o">.</span><span class="nf">registerScene</span><span class="p">(</span><span class="s">"SecondScene"</span><span class="p">,</span> 
<span class="nv">scene</span><span class="p">:</span> <span class="kt">SBSceneContainer</span><span class="p">(</span>
<span class="nv">classType</span><span class="p">:</span> <span class="kt">SecondScene</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> 
<span class="nv">name</span><span class="p">:</span> <span class="s">"SecondScene"</span><span class="p">,</span> 
<span class="nv">transition</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> 
<span class="nv">preloadable</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> 
<span class="nv">category</span><span class="p">:</span> <span class="kt">SBSceneContainer</span><span class="o">.</span><span class="kt">SceneGroup</span><span class="o">.</span><span class="kt">World</span><span class="p">,</span> 
<span class="nv">atlases</span><span class="p">:</span> <span class="p">[</span><span class="s">"atlas3"</span><span class="p">,</span> <span class="s">"atlas4"</span><span class="p">]))</span>
</code></pre>

<p>In <code>FirstScene</code>, we can place this code anywhere:</p>
<pre class="highlight swift"><code><span class="k">if</span> <span class="k">let</span> <span class="nv">nextScene</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">sbViewDelegate</span><span class="p">?</span><span class="o">.</span><span class="n">scenes</span><span class="p">[</span><span class="s">"SecondScene"</span><span class="p">]</span> <span class="p">{</span>
    <span class="k">self</span><span class="o">.</span><span class="n">sbViewDelegate</span><span class="p">?</span><span class="o">.</span><span class="nf">sceneDidFinish</span><span class="p">(</span><span class="n">nextScene</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>Because our scenes extend <code><a href="Classes/SBGameScene.html">SBGameScene</a></code>, the <code>sbViewDelegate</code> has a reference to the <code><a href="Classes/SBSceneManager.html">SBSceneManager</a></code>. Again, all caching, preloading and transitions will be automatically handled.</p>

<p>From here, register as many scenes as you like, and switching between scenes is just a matter of that one if statement and a call to <code>sceneDidFinish(:nextScene)</code>.</p>

<p><strong>Setting a Loading Scene</strong></p>

<p>If the <code><a href="Classes/SBSceneManager.html">SBSceneManager</a></code> detects that the atlases for the next scene are not cached, or if switching to a new <code><a href="Structs/SBSceneContainer.html#/s:11SwitchBoard16SBSceneContainerV10SceneGroupO">SBSceneContainer.SceneGroup</a></code>, a Loading scene will be presented. Currently, this is <strong>hard coded</strong> to <code>Loading.sks</code>. So, if you create that in your project, it will be used.</p>

<p><strong>Scene Groups</strong></p>

<p>Sometimes you want to clear cache between a scene, and sometimes you want to retain it. For example, imagine a world map with sub scenes like a store or troop management. You don&rsquo;t want the user to see a loading screen between that navigation. By setting <code><a href="Structs/SBSceneContainer.html#/s:11SwitchBoard16SBSceneContainerV10SceneGroupO">SBSceneContainer.SceneGroup</a></code>, the scenes will be loaded and cleared together. Then, when the user transitions to a scene of a different group, cache will be cleared, a loading screen will be presented, and the new assets loaded.</p>

<p><strong>Loading Your Own Assets</strong></p>

<p>If you don&rsquo;t want to use the autoloading feature, just supply an empty array for the <code>atlases</code> parameter when registering a scene. Then, in your own code, you can use the built in completion handler:</p>
<pre class="highlight swift"><code><span class="k">override</span> <span class="kd">class</span> <span class="kd">func</span> <span class="nf">loadSceneAssetsWithCompletionHandler</span><span class="p">(</span><span class="nv">handler</span><span class="p">:()</span><span class="o">-&gt;</span><span class="p">())</span> <span class="p">{</span>
    <span class="kt">SBGameScene</span><span class="o">.</span><span class="nf">loadAndCacheSceneAssets</span><span class="p">([</span><span class="s">"atlas1"</span><span class="p">,</span> <span class="s">"atlas2"</span><span class="p">],</span> <span class="nv">handler</span><span class="p">:</span> <span class="n">handler</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>This allows you to perform logic before loading the assets. By then calling <code>loadAndCacheSceneAssets</code>, the caching mechanism is still utilized.</p>

<p><strong>Extendeding SBGameScene</strong></p>

<p>Here is an example of how I extend SBGameScene to utilize all of the features it has:</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">GameScene</span> <span class="p">:</span> <span class="kt">SBGameScene</span> <span class="p">{</span>

    <span class="c1">/// Stored reference to UI / HUD elemtns for quick lookup</span>
    <span class="k">weak</span> <span class="k">var</span> <span class="nv">ui</span> <span class="p">:</span> <span class="kt">UINode</span><span class="p">?</span>

    <span class="c1">// MARK: World Layers</span>

    <span class="c1">/// Setup an array of child SKNodes to hold different visual elements</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">buildWorldLayers</span><span class="p">()</span> <span class="p">{</span>

        <span class="c1">/// I have an action bar at bototm of screen, so this will offset camera boundaries.</span>
        <span class="k">self</span><span class="o">.</span><span class="n">cameraBounds</span> <span class="o">=</span> <span class="kt">CameraBounds</span><span class="p">(</span><span class="nv">lower</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="nv">left</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">upper</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">right</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1">/// Change width of scene if iPad</span>
        <span class="k">if</span> <span class="kt">UIDevice</span><span class="o">.</span><span class="nf">currentDevice</span><span class="p">()</span><span class="o">.</span><span class="n">userInterfaceIdiom</span> <span class="o">==</span> <span class="o">.</span><span class="kt">Pad</span> <span class="p">{</span>
            <span class="k">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="kt">CGSize</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">1536</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1">/// Call SBGamescene .buildWorldLayers which will set up the array of world nodes.</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">buildWorldLayers</span><span class="p">()</span>

        <span class="c1">/// Manually create my own UI layer since it is custom and not empty. Add it to self.layers for easy adding and lookup</span>
        <span class="k">let</span> <span class="nv">ui</span> <span class="o">=</span> <span class="kt">UINode</span><span class="p">()</span>
        <span class="n">ui</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">"UI"</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">childNodeWithName</span><span class="p">(</span><span class="s">"Camera"</span><span class="p">)?</span><span class="o">.</span><span class="nf">addChild</span><span class="p">(</span><span class="n">ui</span><span class="p">)</span>
        <span class="n">ui</span><span class="o">.</span><span class="nf">initDefaults</span><span class="p">(</span><span class="k">self</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">ui</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">ui</span> <span class="o">=</span> <span class="n">ui</span>

        <span class="c1">/// Set the camera as the scenes camera.</span>
        <span class="k">self</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="nf">childNodeWithName</span><span class="p">(</span><span class="s">"Camera"</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">SKCameraNode</span>

        <span class="c1">/// Contrain the camera</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">setCameraBounds</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="n">cameraBounds</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// MARK: Debug</span>

    <span class="c1">/// If debug is enabled in my project, call super function to clean the debug layer every frame.</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">updateDebugLayer</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="kt">Debug</span><span class="o">.</span><span class="kt">Layers</span><span class="o">.</span><span class="n">enabled</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">super</span><span class="o">.</span><span class="nf">updateDebugLayer</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>

</code></pre>

<p>By doing this, I&rsquo;ll have the support of <code><a href="Classes/SBGameScene.html">SBGameScene</a></code>, and can then add onto <code>GameScene</code> for code specific to my project. In the example above, I showed a small snippet of that with the UI layer. The idea behind layers is that the camera will know what the world is, adding children won&rsquo;t require searching the node tree, etc. </p>

<p><strong>Screen Recording</strong></p>

<p>Example code to use screen recording:</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">recordButtonTapped</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">scene</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">scene</span> <span class="k">as?</span> <span class="kt">GameScene</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">scene</span><span class="o">.</span><span class="n">recording</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">scene</span><span class="o">.</span><span class="nf">stopScreenRecordingWithHandler</span><span class="p">({</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="k">in</span>
                <span class="k">if</span> <span class="k">let</span> <span class="nv">icon</span> <span class="o">=</span> <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">root</span><span class="p">?</span><span class="o">.</span><span class="nf">childNodeWithName</span><span class="p">(</span><span class="s">"button_Record"</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">SKSpriteNode</span> <span class="p">{</span>
                    <span class="n">icon</span><span class="o">.</span><span class="n">texture</span> <span class="o">=</span> <span class="kt">SKTexture</span><span class="p">(</span><span class="nv">imageNamed</span><span class="p">:</span> <span class="s">"icon_Record"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">})</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">icon</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">root</span><span class="p">?</span><span class="o">.</span><span class="nf">childNodeWithName</span><span class="p">(</span><span class="s">"button_Record"</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">SKSpriteNode</span> <span class="p">{</span>
                <span class="n">icon</span><span class="o">.</span><span class="n">texture</span> <span class="o">=</span> <span class="kt">SKTexture</span><span class="p">(</span><span class="nv">imageNamed</span><span class="p">:</span> <span class="s">"icon_StopRecord"</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="n">scene</span><span class="o">.</span><span class="nf">startScreenRecording</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h5 id='documentation' class='heading'>Documentation</h5>

<p>Docs are located at <a href="http://veeneck.github.io/SwitchBoard">veeneck.github.io/SwitchBoard</a> and are generated with <a href="https://github.com/Realm/jazzy">Jazzy</a>. The config file for the documentation is in the project as <code>config.yml</code>. Docs can be generated by running this command <strong>in</strong> the project directory:</p>
<pre class="highlight plaintext"><code>jazzy --config {PATH_TO_REPOSITORY}/SwitchBoard/SwitchBoard/config.yml
</code></pre>

<p><strong>Note</strong>: The output in the <code>config.yml</code> is hard coded to one computer. Edit the file and update the <code>output</code> flag to a valid location.</p>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2018 <a class="link" href="http://battleofbrothers.com" target="_blank" rel="external">Ryan Campbell</a>. All rights reserved. (Last updated: 2018-05-07)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.2</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
